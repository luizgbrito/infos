<!DOCTYPE html>
<!--
================================================================================
                           DOCUMENTAÇÃO DO PROJETO
================================================================================

NOME DO PROJETO: Quaresma do Padre Pio

INFORMAÇÕES TÉCNICAS:
- Quaresma do Padre Pio (Upsell 1)
- Player de Vídeo: Strapcast
- Plataforma de Vendas: Hotmart
- VSL: [1 UPSELL] - [QQP] - [V1] - [R$49] - Hotmart

ÚLTIMA ATUALIZAÇÃO: [25/07/2025]
VERSÃO: [VERSÃO]
================================================================================
-->
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upsell 1 - Músicas dos Anjos</title>

  <!-- Preload da thumbnail do vídeo -->
  <script>
    const VIDEO_ID      = 'vidBDeAtgjgrVxH';
    const CONTAINER_ID  = 'ctn_1752859371748';
    const THUMB_URL     = `https://delivery.i-cdn.net/stream/${VIDEO_ID}/ThumbnailStart.jpg`;
    const PLAYER_JS_URL = `https://delivery.i-cdn.net/stream/${VIDEO_ID}/player.js`;
    let preloadLink = document.querySelector('link[rel="preload"][as="image"]');
    if (!preloadLink) {
      preloadLink = document.createElement('link');
      preloadLink.rel         = 'preload';
      preloadLink.as          = 'image';
      preloadLink.crossOrigin = 'anonymous';
      document.head.appendChild(preloadLink);
    }
    preloadLink.href = THUMB_URL;
  </script>

  <!-- DNS Prefetch para performance -->
  <link rel="dns-prefetch" href="https://delivery.i-cdn.net">
  <link rel="dns-prefetch" href="https://cdn-wftossaz9s.i-cdn.net">
  <link rel="dns-prefetch" href="https://m3u8.strapcast.com">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #fff;
      color: #111;
      font-family: 'Segoe UI', Arial, sans-serif;
      min-height: 100vh;
      box-sizing: border-box;
    }
    .banner-topo {
      width: 100%;
      background: #ff0000;
      color: #fff;
      font-weight: bold;
      text-align: center;
      padding: 14px 2vw 12px;
      font-size: 1.08rem;
      letter-spacing: 0.5px;
    }
    .video-container {
      display: flex;
      justify-content: center;
      padding: 20px 12px 0;
    }
    .video-container > div {
      width: 100%;
      max-width: 400px;
      position: relative;
    }
    #hotmart-widget-wrapper {
      display: none;
      margin-top: 24px;
    }
    @media (max-width: 600px) {
      .banner-topo {
        font-size: 0.98rem;
        padding: 10px 2vw 8px;
      }
      .video-container {
        padding: 20px 4vw 0;
      }
    }
  </style>

  <!-- UTMify & Pixel -->
  <script src="js/latest.js" async defer></script>
  <script>
    window.pixelId = "681a6d134a2a05ae986fc0a6";
    const utmScript = document.createElement("script");
    utmScript.async = true;
    utmScript.defer = true;
    utmScript.src = "https://cdn.utmify.com.br/scripts/pixel/pixel.js";
    document.head.appendChild(utmScript);
  </script>
</head>
<body>

  <div class="banner-topo">
    ATENÇÃO: sua compra ainda não está concluída. Não saia dessa página ainda!
  </div>

  <div style="text-align:center; margin:30px auto; max-width:400px; font-size:1.6em; font-weight:bold; line-height:1.3; color:#000;">
    PARE AGORA: esta música tem o poder de realizar milagres
  </div>

  <div class="video-container">
    <div>
      <!-- Strapcast player container -->
      <div id="strap-player-container" style="width:100%; padding-top:125%;">
        <div></div>
      </div>

      <!-- Strapcast player script -->
      <script>
        // monta o Strapcast player
        const strapDiv = document.querySelector('#strap-player-container > div');
        strapDiv.id = CONTAINER_ID;
        strapDiv.innerHTML = `
          <div id="vid_${VIDEO_ID}" style="position:absolute; top:0; left:0; width:100%; height:100%;">
            <img src="${THUMB_URL}" style="width:100%; height:100%; object-fit:cover;" alt="thumbnail" />
            <div style="backdrop-filter:blur(5px); position:absolute; top:0; width:100%; height:100%;"></div>
          </div>`;
        const playerScript = document.createElement("script");
        playerScript.async = true;
        playerScript.src = PLAYER_JS_URL;
        document.head.appendChild(playerScript);
      </script>

      <!-- wrapper para manter o widget Hotmart oculto até o delay -->
      <div id="hotmart-widget-wrapper">
        <!-- HOTMART - Sales Funnel Widget -->
        <!--- sales funnel container --->
        <div id="hotmart-sales-funnel"></div>
        <!--- script load and setup --->
        <script src="https://checkout.hotmart.com/lib/hotmart-checkout-elements.js"></script>
        <script>
          checkoutElements.init('salesFunnel').mount('#hotmart-sales-funnel')
        </script>
        <!-- HOTMART - Sales Funnel Widget -->
      </div>

      <!-- lógica de delay vinculada ao widget -->
      <script>
        let widgetShown = false;

        function showHotmartWidget() {
          const wrapper = document.getElementById('hotmart-widget-wrapper');
          wrapper.style.display = 'block';
          console.log('Widget Hotmart exibido');
        }

        function checkVideoTime() {
          const videoEl = document.querySelector('video');
          if (videoEl) {
            const currentTime = videoEl.currentTime;
            console.log('Tempo atual do vídeo:', currentTime);
            // exibe após 7m14s (434s)
            if (currentTime >= 0 && !widgetShown) {
              widgetShown = true;
              showHotmartWidget();
              return;
            }
          }
          if (!widgetShown) {
            setTimeout(checkVideoTime, 1000);
          }
        }

        document.addEventListener('DOMContentLoaded', function() {
          console.log('DOM pronto, iniciando verificação de tempo...');
          setTimeout(checkVideoTime, 2000);
        });
      </script>

    </div>
  </div>

</body>
</html>
